(this["webpackJsonp@freight-trust/web3-react-app"]=this["webpackJsonp@freight-trust/web3-react-app"]||[]).push([[0],{191:function(e,t,n){e.exports=n(470)},212:function(e,t){},220:function(e,t){},237:function(e,t){},239:function(e,t){},254:function(e,t){},256:function(e,t){},404:function(e,t){},415:function(e,t){},418:function(e,t){},470:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(185),c=n.n(o),i=n(3),s=n(4),u=n(8),l=n(9),p=n(186),d=n(7),m=n(75),f=n(23),b=n.n(f),h=n(74),g=n(108),v=n.n(g),y=r.a.createContext({contract:{},account:{},web3:{},transactions:{},initWeb3:function(){},initContract:function(){},initAccount:function(){}}),w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).initWeb3=Object(h.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n={},window.ethereum?(console.log("Using modern web3 provider."),n=new v.a(window.ethereum)):window.web3?(console.log("Legacy web3 provider. Try updating."),n=new v.a(window.web3.currentProvider)):(console.log("Non-Ethereum browser detected. You should consider trying MetaMask!"),n=!1),e.setState({web3:n});case 3:case"end":return t.stop()}}),t)}))),e.initContract=function(){var t=Object(h.a)(b.a.mark((function t(n,a){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("creating contract"),t.prev=1,t.next=4,new e.state.web3.eth.Contract(a,n);case 4:r=t.sent,e.setState({contract:r}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.log("Could not create contract."),window.toastProvider.addMessage("Contract creation failed.",{variant:"failure"});case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}(),e.initAccount=Object(h.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.ethereum.enable().then((function(t){var n=t[0];e.setState({account:n}),console.log("wallet address:",e.state.account)}));case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),console.log("error:",t.t0),window.toastProvider.addMessage("User needs to CONNECT wallet",{variant:"failure"});case 9:case"end":return t.stop()}}),t,null,[[0,5]])}))),e.contractMethodSendWrapper=function(t){var n=e.createTransaction();e.addTransaction(n),n.method=t,n.type="contract",n.status="started",e.updateTransaction(n);var a=e.state,r=a.contract,o=a.account;try{r.methods[t]().send({from:o}).on("transactionHash",(function(t){n.transactionHash=t,n.status="pending",n.recentEvent="transactionHash",e.updateTransaction(n)})).on("confirmation",(function(t,a){n.confirmationCount+=1;1===n.confirmationCount?n.status="confirmed":n.confirmationCount<3||(3===n.confirmationCount?a.status?n.status="success":a.status||(n.status="error"):n.confirmationCount),n.recentEvent="confirmation",e.updateTransaction(n)})).on("receipt",(function(t){n.recentEvent="receipt",e.updateTransaction(n)})).on("error",(function(t){n.status="error",n.recentEvent="error",e.updateTransaction(n),window.toastProvider.addMessage("Value change failed",{secondaryMessage:"Could not change value.",actionHref:"",actionText:"",variant:"failure"})}))}catch(c){n.status="error",e.updateTransaction(n),window.toastProvider.addMessage("Value change failed",{secondaryMessage:"Could not change value on smart contract",actionHref:"",actionText:"",variant:"failure"})}},e.createTransaction=function(){var e={};return e.created=Date.now(),e.lastUpdated=Date.now(),e.status="initialized",e.confirmationCount=0,e},e.addTransaction=function(t){var n=Object(m.a)({},e.state.transactions);n["tx".concat(t.created)]=t,e.setState({transactions:n})},e.updateTransaction=function(t){var n=Object(m.a)({},e.state.transactions),a=Object(m.a)({},t);a.lastUpdated=Date.now(),n["tx".concat(t.created)]=a,e.setState({transactions:n})},e.state={contract:{},account:null,web3:null,transactions:{},initWeb3:e.initWeb3,initContract:e.initContract,initAccount:e.initAccount,contractMethodSendWrapper:e.contractMethodSendWrapper},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.initWeb3()}},{key:"render",value:function(){return r.a.createElement(y.Provider,Object.assign({value:this.state},this.props))}}]),n}(r.a.Component);w.Consumer=y.Consumer;var E=w,C=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(d.a,{bg:"primary",p:3,justifyContent:"center",flexDirection:"column"},r.a.createElement(d.d,{justifyContent:"flex-end"},r.a.createElement(d.f,{href:"https://github.com/ConsenSys/rimble-app-demo",target:"_blank"},r.a.createElement(d.b,null,"GitHub"))),r.a.createElement(d.a,{width:"400px",mx:"auto"},r.a.createElement(d.e.h2,{color:"white"},"Rimble App Demo")))}}]),n}(r.a.Component),j={started:{message:"Change submitted",secondaryMessage:"Confirm in MetaMask",actionHref:"",actionText:"",variant:"default",icon:"InfoOutline"},pending:{message:"Processing change...",secondaryMessage:"This may take a few minutes",actionHref:"",actionText:"",variant:"processing"},confirmed:{message:"First block confirmed",secondaryMessage:"Your change is in progress",actionHref:"",actionText:"",variant:"processing"},success:{message:"Smart contract value changed",variant:"success"},error:{message:"Value change failed",secondaryMessage:"Make sure you have enough Ether (ETH) and try again",actionHref:"",actionText:"",variant:"failure"}},k=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).collectionHasNewObject=function(e,t){return"undefined"===typeof e||Object.keys(e).length!==Object.keys(t).length},e.getNewObjectFromCollection=function(e,t){if("undefined"!==typeof e){var n=Object.keys(t).filter((function(t){return!Object.keys(e).includes(t)}));return t[n]}return Object.keys(t).map((function(e){return t[e]}))},e.getUpdatedObjectFromCollection=function(e,t){return Object.keys(e).map((function(n){return e[n].lastUpdated!==t[n].lastUpdated?t[n]:null})).filter((function(e){return null!==e}))[0]},e.getTransactionFromCollection=function(e,t){return t["tx".concat(e)]},e.getUpdatedTransaction=function(t,n){var a=null,r={},o={};return e.collectionHasNewObject(t,n)?a=e.getNewObjectFromCollection(t,n):(r=e.getUpdatedObjectFromCollection(t,n),o=e.getTransactionFromCollection(r.created,t),r.status!==o.status&&(a=r)),a},e.processTransactionUpdates=function(t){var n=null;Object.keys(e.props.transactions).length&&(n=e.getUpdatedTransaction(t.transactions,e.props.transactions)),null!==n&&"undefined"!==typeof n&&e.showTransactionToast(n)},e.showTransactionToast=function(t){var n=e.getTransactionToastMeta(t);window.toastProvider.addMessage(".",n)},e.getTransactionToastMeta=function(e){var t={};switch(e.status){case"started":t=j.started;break;case"pending":t=j.pending;break;case"confirmed":t=j.confirmed;break;case"success":t=j.success;break;case"error":t=j.error}return t},e}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(e,t){this.processTransactionUpdates(e)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.k.Provider,{ref:function(e){return window.toastProvider=e}}))}}]),n}(r.a.Component),O=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(d.d,{flexDirection:"column",alignItems:"center",px:3,py:5},r.a.createElement(d.e.h3,{textAlign:"center",pb:4},"Connect with MetaMask to try out the demo"),r.a.createElement(d.g,{size:"medium",mx:"auto",onClick:this.props.initAccount,disabled:this.props.account},"Connect with MetaMask"))}}]),n}(r.a.Component),x=[{constant:!1,inputs:[],name:"decrementCounter",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"incrementCounter",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"reset",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{constant:!0,inputs:[],name:"getCounter",outputs:[{name:"",type:"int256"}],payable:!1,stateMutability:"view",type:"function"}],M=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={value:0,needsUpdate:!1},e.getNumber=function(t){Object.assign({},t);var n=e.props.contract;try{n.methods.getCounter().call().then((function(t){t=Number(t.toString()),e.setState({value:t,needsUpdate:!1})})).catch((function(t){console.log(t),e.setState({error:t})}))}catch(a){console.log("error",a)}},e.processTransactionUpdates=function(t){Object.keys(e.props.transactions).map((function(t){return!("success"!==e.props.transactions[t].status||!e.state.needsUpdate)&&(console.log("Getting updated number."),e.getNumber(),!1)}))},e.resetCounter=function(){e.props.contractMethodSendWrapper("reset")},e.incrementCounter=function(){e.props.contractMethodSendWrapper("incrementCounter"),e.setState({needsUpdate:!0})},e.decrementCounter=function(){e.props.contractMethodSendWrapper("decrementCounter"),e.setState({needsUpdate:!0})},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.initContract("0x0f69f0ac4b92bf0d101b5747eed3fa6b653a36f8",x).then((function(){e.getNumber()}))}},{key:"componentDidUpdate",value:function(e,t){this.processTransactionUpdates(e)}},{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement(d.d,{px:0,pb:4,borderBottom:1,borderColor:"#E8E8E8",justifyContent:"space-between",alignItems:"end"},r.a.createElement(d.i,{mb:2,fontSize:3},"Smart contract value"),r.a.createElement(d.h,{size:"small",onClick:this.resetCounter,disabled:!this.props.account},"Reset")),r.a.createElement(d.a,{py:4},r.a.createElement(d.i,{fontSize:6,textAlign:"center"},this.state.value)),r.a.createElement(d.d,{px:0,pt:4,borderTop:1,borderColor:"#E8E8E8",justifyContent:"space-between"},r.a.createElement(d.b,{size:"medium",mr:4,onClick:this.incrementCounter},"Increase value"),r.a.createElement(d.b,{size:"medium",onClick:this.decrementCounter},"Decrease value")))}}]),n}(r.a.Component),T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(d.c,{width:"400px",mx:"auto",px:4},r.a.createElement(d.e.h2,{fontSize:3,textAlign:"center",px:4,mb:5},"Transactions"),r.a.createElement(d.a,null,Object.keys(this.props.transactions).length>0?r.a.createElement(d.d,null,r.a.createElement(d.i,{width:"33%",textAlign:"center",fontWeight:"bold"},"txHash"),r.a.createElement(d.i,{width:"33%",textAlign:"center",fontWeight:"bold"},"Status"),r.a.createElement(d.i,{width:"33%",textAlign:"center",fontWeight:"bold"},"Confirmations")):null,Object.keys(this.props.transactions).length<1?r.a.createElement(d.i,{textAlign:"center"},"No recent transactions"):Object.keys(this.props.transactions).map((function(t,n){var a="";if(e.props.transactions[t].transactionHash){var o=(a=e.props.transactions[t].transactionHash.toString()).substr(0,7),c=a.substr(a.length-4);a=o+"..."+c}return r.a.createElement(d.d,null,r.a.createElement(d.i,{width:"33%",textAlign:"center"},a),r.a.createElement(d.i,{width:"33%",textAlign:"center"},e.props.transactions[t].status),r.a.createElement(d.i,{width:"33%",textAlign:"center"},e.props.transactions[t].confirmationCount))}))))}}]),n}(r.a.Component),S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(E.Consumer,null,(function(e){var t=e.contract,n=e.account,a=e.transactions,o=e.initContract,c=e.initAccount,i=e.contractMethodSendWrapper;return r.a.createElement("div",null,r.a.createElement(d.c,{width:"400px",mx:"auto",px:4},n?r.a.createElement(M,{contract:t,account:n,transactions:a,initContract:o,contractMethodSendWrapper:i}):r.a.createElement(O,{initAccount:c,account:n})),r.a.createElement(T,{transactions:a}),r.a.createElement(k,{transactions:a}))}))}}]),n}(r.a.Component),A=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(d.a,{width:"400px",mx:"auto",mt:4},r.a.createElement(d.e.h3,null,"Instructions:"),r.a.createElement("ol",null,r.a.createElement("li",null,r.a.createElement(d.i,{p:1},"Make sure MetaMask is working in your browser")),r.a.createElement("li",null,r.a.createElement(d.i,{p:1},"Set the network to Rinkeby Test Network")),r.a.createElement("li",null,r.a.createElement(d.i,{p:1},"You'll need a little bit of ETH for gas fees"))))}}]),n}(r.a.Component),U=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(d.c,{width:"600px",mx:"auto",px:4},r.a.createElement(d.e.h2,null,"No Web3 Provider Available"),r.a.createElement(d.i,null,"You will need to ",r.a.createElement(d.f,{href:"https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en",target:"_blank"},"install MetaMask")," to use this dApp."))}}]),n}(r.a.Component),W={fontSizes:[12,14,16,20,24,32,48,64],fontWeights:[0,300,400,600,700],lineHeights:{solid:1,title:1.25,copy:1.5},fonts:{serif:"athelas, georgia, times, serif",sansSerif:'"Source Sans Pro", -apple-system, sans-serif'},space:[0,4,8,16,32,64,128,256],radii:["0","4px","8px","16px"],width:[0,16,32,64,128,256],minWidths:[0,16,32,64,128,256],maxWidths:[0,16,32,64,128,256,512,768,1024,1536],heights:[0,16,32,64,128,256],minHeights:[0,16,32,64,128,256],maxHeights:[0,16,32,64,128,256],borders:[0,"1px solid"],shadows:["0","0px 2px 4px rgba(0, 0, 0, 0.1)","0 7px 14px rgba(50,50,93,.1)"],opacity:{disabled:.4},colors:{primary:"#4E3FCE",blue:"#007ce0",navy:"#004175",copyColor:"#3F3D4B",black:"#000e1a","near-black":"#111","dark-gray":"#333","mid-gray":"#555",grey:"#CCC",silver:"#999","light-silver":"#aaa","moon-gray":"#ccc","light-gray":"#eee","near-white":"#f4f4f4",white:"#fff",transparent:"transparent",blacks:["rgba(0,0,0,.0125)","rgba(0,0,0,.025)","rgba(0,0,0,.05)","rgba(0,0,0,.1)","rgba(0,0,0,.2)","rgba(0,0,0,.3)","rgba(0,0,0,.4)","rgba(0,0,0,.5)","rgba(0,0,0,.6)","rgba(0,0,0,.7)","rgba(0,0,0,.8)","rgba(0,0,0,.9)"],whites:["rgba(255,255,255,.0125)","rgba(255,255,255,.025)","rgba(255,255,255,.05)","rgba(255,255,255,.1)","rgba(255,255,255,.2)","rgba(255,255,255,.3)","rgba(255,255,255,.4)","rgba(255,255,255,.5)","rgba(255,255,255,.6)","rgba(255,255,255,.7)","rgba(255,255,255,.8)","rgba(255,255,255,.9)"]}},H=n(1);function N(){var e=Object(p.a)(["\n  body, html {\n    margin: 0;\n    padding: 0;\n    background-color: #efefef;\n  }\n"]);return N=function(){return e},e}var D=Object(H.b)(N()),P=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(d.j,{theme:W,className:"App"},r.a.createElement(C,null),r.a.createElement(d.d,{justifyContent:"center",p:4},r.a.createElement(d.i,{width:"400px"},"This is a starter React dApp that uses the Rimble UI component library to call methods on a smart contract deployed to the Ethereum Rinkeby testnet.")),r.a.createElement(E,null,r.a.createElement(E.Consumer,null,(function(e){var t=e.web3;return r.a.createElement(d.a,null,t?r.a.createElement(S,null):r.a.createElement(U,null))}))),r.a.createElement(A,null),r.a.createElement(D,null))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[191,1,2]]]);
//# sourceMappingURL=main.8c154ae9.chunk.js.map